/* Modernized component styles leveraging global design tokens */
.certificate-generator { max-width:1250px; margin:0 auto 4rem; padding:2.2rem 2rem 3rem; position:relative; animation:fadeIn .5s ease; }
h1 { text-align:center; margin:0 0 2.2rem; letter-spacing:.5px; }
/* Hidden step keeps DOM mounted to persist state */
.hidden-step { display:none !important; }
/* Canvas wrapper overlay mode */
.canvas-wrapper { position:relative; width:100%; display:flex; justify-content:center; }
.canvas-shell { position:relative; display:flex; width:100%; align-items:flex-start; }
.canvas-shell.always-open .side-panel { opacity:1; transform:none; pointer-events:auto; }
.canvas-shell .canvas-stage { position:relative; flex:1; display:flex; justify-content:center; }
.canvas-shell .canvas-stage canvas { max-width:100%; height:auto; transition:transform .3s ease; }
.always-open .side-panel ~ .canvas-stage canvas { transform:scale(1); }
.side-panel { position:relative; width:360px; flex:0 0 360px; opacity:1; transform:none; pointer-events:auto; margin-left:1.2rem; }
.side-panel-inner { background:rgba(18,23,29,.95); backdrop-filter:blur(8px); height:100%; border:1px solid var(--color-border-strong); border-radius:var(--radius); padding:1rem .9rem 1.2rem; box-shadow:-10px 0 25px -8px rgba(0,0,0,.6); overflow:auto; }
.side-panel-inner h3 { margin:.2rem 0 .7rem; font-size:.65rem; text-transform:uppercase; letter-spacing:1px; font-weight:600; color:var(--color-text-soft); }
.accordion { display:flex; flex-direction:column; gap:.55rem; }
.acc-item { border:1px solid var(--color-border); border-radius:var(--radius-sm); background:linear-gradient(145deg,#1d252e,#232d37); overflow:hidden; transition:var(--transition); }
.acc-item.expanded { border-color:var(--color-accent); box-shadow:0 0 0 1px var(--color-accent); }
.acc-header { width:100%; background:none; border:none; color:var(--color-text-soft); font-size:.7rem; font-weight:600; letter-spacing:.5px; padding:.55rem .7rem; display:flex; align-items:center; justify-content:space-between; cursor:pointer; text-align:left; }
.acc-header:hover { background:rgba(255,255,255,.05); color:#fff; }
.acc-body { padding:.55rem .65rem .7rem; display:flex; flex-direction:column; gap:.55rem; animation:fadeIn .25s ease; }
.acc-row.actions { display:flex; gap:.4rem; }
.mini { background:var(--color-surface-alt); border:1px solid var(--color-border); color:var(--color-text-soft); font-size:.6rem; padding:.3rem .55rem; border-radius:var(--radius-xs); cursor:pointer; line-height:1; font-weight:600; letter-spacing:.5px; }
.mini.primary { background:var(--color-accent); border-color:var(--color-accent); color:#fff; }
.mini.active { background:var(--color-success); border-color:var(--color-success); color:#fff; }
.mini:hover { background:var(--color-accent); color:#fff; }
.mini.primary:hover { filter:brightness(1.1); }
.acc-grid { display:grid; grid-template-columns:repeat(2,1fr); gap:.55rem .6rem; }
.acc-grid label { display:flex; flex-direction:column; gap:.25rem; font-size:.52rem; font-weight:600; color:var(--color-text-faint); letter-spacing:.5px; }
.acc-grid input, .acc-grid select { background:var(--color-surface); border:1px solid var(--color-border); border-radius:var(--radius-xs); font-size:.6rem; padding:.3rem .4rem; color:var(--color-text); }
.acc-grid input:focus, .acc-grid select:focus { outline:2px solid var(--color-accent); outline-offset:1px; }
.options-grid { display:grid; grid-template-columns:repeat(3,1fr); gap:.5rem .6rem; font-size:.55rem; margin-top:.4rem; }
.options-grid label { display:flex; flex-direction:column; gap:.2rem; background:var(--color-surface-alt); border:1px solid var(--color-border); padding:.4rem .45rem; border-radius:var(--radius-xs); font-weight:600; letter-spacing:.5px; color:var(--color-text-faint); }
.options-grid input[type=number] { width:100%; }
.options-grid input, .options-grid select { background:var(--color-surface); border:1px solid var(--color-border); border-radius:var(--radius-xs); font-size:.55rem; padding:.25rem .3rem; color:var(--color-text); }
@media (max-width:980px){ .canvas-shell { flex-direction:column; } .side-panel { width:100%; margin:1rem 0 0; } }
/* Fullscreen adjustments */
:fullscreen canvas { max-width:100% !important; width:100% !important; height:auto !important; }
:fullscreen .side-panel { display:none; }
:fullscreen .canvas-stage { justify-content:center; }
.floating-panel { position:absolute; top:12px; left:12px; width:300px; max-height:calc(100% - 24px); display:flex; flex-direction:column; background:rgba(18,23,29,.92); backdrop-filter:blur(6px); border:1px solid var(--color-border-strong); border-radius:var(--radius); box-shadow:0 10px 25px -5px rgba(0,0,0,.5); font-size:.65rem; overflow:hidden; }
.fp-header { display:flex; align-items:center; justify-content:space-between; padding:.55rem .75rem; background:linear-gradient(135deg,var(--color-surface-alt),rgba(255,255,255,.04)); border-bottom:1px solid var(--color-border); font-weight:600; letter-spacing:.8px; text-transform:uppercase; font-size:.58rem; }
.fp-close { background:none; border:none; color:var(--color-text-soft); font-size:1rem; cursor:pointer; line-height:1; padding:.1rem .3rem; border-radius:4px; }
.fp-close:hover { background:rgba(255,255,255,.08); color:#fff; }
.fp-body { overflow:auto; padding:.6rem .65rem .8rem; display:flex; flex-direction:column; gap:.55rem; }
.fp-field { border:1px solid var(--color-border); border-radius:var(--radius-xs); padding:.45rem .5rem .55rem; background:linear-gradient(145deg,#1d262f,#212c36); display:flex; flex-direction:column; gap:.45rem; transition:var(--transition); }
.fp-field.active { border-color:var(--color-accent); box-shadow:0 0 0 1px var(--color-accent); }
.fp-field-row { display:flex; gap:.4rem; align-items:center; }
.fp-select { flex:1; background:var(--color-surface); border:1px solid var(--color-border-strong); color:var(--color-text-soft); padding:.35rem .5rem; font-size:.65rem; font-weight:600; letter-spacing:.5px; border-radius:var(--radius-xs); text-align:left; cursor:pointer; transition:var(--transition); }
.fp-select:hover { background:var(--color-surface-alt); color:#fff; }
.mini-btn { background:var(--color-surface-alt); border:1px solid var(--color-border); color:var(--color-text-soft); font-size:.6rem; padding:.3rem .45rem; border-radius:var(--radius-xs); cursor:pointer; line-height:1; }
.mini-btn:hover { background:var(--color-accent); color:#fff; }
.fp-grid { display:grid; grid-template-columns:repeat(2,1fr); gap:.4rem .5rem; }
.fp-grid label { display:flex; flex-direction:column; gap:.2rem; font-size:.55rem; color:var(--color-text-faint); font-weight:600; letter-spacing:.5px; }
.fp-grid input, .fp-grid select { background:var(--color-surface); border:1px solid var(--color-border); border-radius:var(--radius-xs); padding:.25rem .35rem; font-size:.6rem; color:var(--color-text); }
.fp-grid input:focus, .fp-grid select:focus { outline:2px solid var(--color-accent); outline-offset:1px; }
.fp-footer { display:flex; flex-wrap:wrap; gap:.4rem .6rem; padding:.55rem .65rem .65rem; border-top:1px solid var(--color-border); background:linear-gradient(135deg,var(--color-surface-alt),rgba(255,255,255,.03)); }
.fp-inline { display:flex; align-items:center; gap:.25rem; font-size:.55rem; color:var(--color-text-faint); }
.fp-inline input[type=number] { background:var(--color-surface); border:1px solid var(--color-border); border-radius:4px; padding:.15rem .3rem; font-size:.55rem; width:50px; }
.fp-inline input[type=checkbox] { transform:scale(.9); }
@media (max-width:680px){ .floating-panel { position:static; width:100%; max-height:320px; } .canvas-wrapper.overlay-active { flex-direction:column; } }

.upload-section { display:grid; grid-template-columns:repeat(auto-fit,minmax(300px,1fr)); gap:1.4rem; margin:0 0 2.2rem; }

.upload-card { position:relative; border:1px dashed var(--color-border-strong); border-radius:var(--radius); padding:1.5rem 1.3rem 1.6rem; background:linear-gradient(145deg,var(--color-surface),var(--color-surface-alt)); box-shadow:var(--shadow-sm); transition:var(--transition); overflow:hidden; text-align:center; }
.upload-card:hover { border-color:var(--color-accent); box-shadow:var(--shadow); }
.upload-card h3 { margin:0 0 .75rem; font-size:.95rem; font-weight:600; color:var(--color-text-soft); letter-spacing:.5px; display:flex; align-items:center; justify-content:center; gap:.5rem; }
.upload-card h3::before { content:""; width:8px; height:8px; background:var(--color-accent); border-radius:50%; box-shadow:0 0 0 4px rgba(79,140,255,.15); }

.file-input { width:100%; max-width:360px; margin-top:.25rem; }

.image-preview {
  margin-top: 15px;
}

.preview-image { max-width:100%; max-height:220px; border-radius:var(--radius-sm); border:1px solid var(--color-border); box-shadow:var(--shadow-sm); }

/* Data preview */
.excel-preview { margin-top:1rem; text-align:left; }
.data-table { width:100%; border-collapse:collapse; margin-top:.75rem; font-size:.75rem; border:1px solid var(--color-border-strong); }
.data-table th, .data-table td { padding:6px 8px; text-align:left; border:1px solid var(--color-border); }
.data-table th { background: var(--color-surface-alt); font-weight:600; letter-spacing:.3px; }
.data-table tr:nth-child(even) td { background:rgba(255,255,255,0.02); }
.data-table tr:hover td { background:rgba(255,255,255,.06); }

.positioning-section { margin-top:30px; }

/* Instructions panel */
.instructions { background:linear-gradient(135deg,rgba(79,140,255,.15),rgba(127,91,255,.12)); border:1px solid var(--color-border-strong); border-radius:var(--radius); padding:1.1rem 1.2rem 1.2rem; margin:0 0 1.4rem; position:relative; overflow:hidden; }
.instructions::after { content:""; position:absolute; inset:0; background:radial-gradient(circle at 85% 15%, rgba(255,255,255,.15), transparent 60%); pointer-events:none; }
.instructions ul { list-style:none; margin:.6rem 0 0; padding:0; display:grid; gap:.4rem; }
.instructions li { font-size:.72rem; color:var(--color-text-soft); display:flex; gap:.4rem; align-items:flex-start; }
.instructions li:before { content:"▹"; color:var(--color-accent); font-size:.8rem; line-height:1.1; position:relative; top:1px; }

.field-green { color: var(--color-success); font-weight:600; }
.field-red { color: var(--color-danger); font-weight:600; }

/* Canvas area */
.canvas-container { border:1px solid var(--color-border-strong); margin:20px 0; display:inline-block; background:repeating-linear-gradient(45deg,#222a33 0 10px,#252e38 10px 20px); position:relative; box-shadow:var(--shadow); padding:10px; border-radius:var(--radius); }
.canvas-container:before { content:"Canvas"; position:absolute; top:8px; right:12px; font-size:.55rem; letter-spacing:1px; background:var(--color-surface-alt); padding:3px 6px; border-radius:999px; color:var(--color-text-faint); border:1px solid var(--color-border); }
.canvas-container canvas { display:block; cursor:crosshair; background:#fff; border-radius:var(--radius-sm); }

/* Field controls */
.field-controls { display:grid; grid-template-columns:repeat(auto-fit,minmax(260px,1fr)); gap:1rem; margin:1.4rem 0 1.8rem; }
.field-control { padding:1rem 1rem 1.1rem; background:linear-gradient(145deg,var(--color-surface-alt),var(--color-surface)); border:1px solid var(--color-border); border-radius:var(--radius-sm); position:relative; transition:var(--transition); }
.field-control:hover { border-color:var(--color-accent); }
.field-control label { display:block; margin:0 0 .35rem; font-size:.65rem; text-transform:uppercase; letter-spacing:.8px; color:var(--color-text-faint); font-weight:600; }

/* Field selection button */
.select-field-btn { width:100%; background:var(--color-surface-alt); border:1px solid var(--color-border-strong); color:var(--color-text-soft); font-size:.7rem; font-weight:600; padding:6px 10px; letter-spacing:.5px; border-radius:var(--radius-xs); text-transform:uppercase; cursor:pointer; transition:var(--transition); }
.select-field-btn:hover { background:var(--color-surface); color:#fff; }
.select-field-btn.selected { background:var(--color-success); color:#fff; border-color:var(--color-success); box-shadow:0 0 0 1px rgba(48,199,146,.4); }
.select-field-btn.selected:hover { background:var(--color-success-hover); }

/* Field settings grid */
.field-settings { display:grid; grid-template-columns:repeat(2,1fr); gap:.6rem .75rem; margin-top:.5rem; }
.field-settings input, .field-settings select { padding:4px 6px; font-size:.65rem; border:1px solid var(--color-border); border-radius:var(--radius-xs); background:var(--color-surface-alt); color:var(--color-text); }
.field-settings input:focus, .field-settings select:focus { outline:2px solid var(--color-accent); outline-offset:2px; }

/* Action buttons */
.action-buttons { text-align:center; margin-top:1rem; }
.preview-btn, .generate-btn { padding:12px 24px; margin:0 10px; border:none; border-radius:var(--radius-sm); font-size:.85rem; font-weight:600; letter-spacing:.5px; cursor:pointer; transition:var(--transition); }
.preview-btn { background:var(--color-success); color:#fff; }
.preview-btn:hover:not(:disabled) { background:var(--color-success-hover); }
.generate-btn { background:var(--color-danger); color:#fff; }
.generate-btn:hover:not(:disabled) { background:var(--color-danger-hover); }
.preview-btn:disabled, .generate-btn:disabled { opacity:.45; cursor:not-allowed; }

/* Progress info */
.progress-info { text-align:center; margin-top:1.5rem; padding:1rem 1.2rem; background:linear-gradient(145deg,#2d2a14,#3a3112); border:1px solid #6a5110; color:#f7d58b; border-radius:var(--radius-sm); font-size:.8rem; box-shadow:var(--shadow-sm); }

/* Preview panel */
.preview-section { margin-top:2rem; text-align:center; border:1px solid var(--color-border); border-radius:var(--radius); padding:1.4rem 1.6rem 1.6rem; background:linear-gradient(145deg,var(--color-surface),var(--color-surface-alt)); box-shadow:var(--shadow); }
.certificate-preview { max-width:100%; max-height:520px; border:1px solid var(--color-border-strong); border-radius:var(--radius-sm); box-shadow:var(--shadow-sm); }

/* Step 3 side layout */
.preview-flex { display:flex; gap:1.6rem; align-items:flex-start; margin-top:1.2rem; }
.preview-main { flex:1 1 auto; min-width:0; }
.preview-side { width:300px; flex:0 0 300px; display:flex; flex-direction:column; gap:1rem; }
.group-box { border:1px solid var(--color-border); background:linear-gradient(145deg,var(--color-surface-alt),var(--color-surface)); padding:1rem 1rem 1.15rem; border-radius:var(--radius-sm); box-shadow:var(--shadow-sm); font-size:.7rem; }
.group-box label { font-weight:600; color:var(--color-text-soft); font-size:.65rem; letter-spacing:.5px; display:block; }
.group-box select { width:100%; margin-top:.45rem; background:var(--color-surface); border:1px solid var(--color-border-strong); color:var(--color-text); padding:.5rem .6rem; border-radius:var(--radius-xs); font-size:.7rem; }
.group-box select:focus { outline:2px solid var(--color-accent); outline-offset:1px; }

@media (max-width:1100px){
  .preview-flex { flex-direction:column; }
  .preview-side { width:100%; flex:0 0 auto; }
}

/* Align preview image top with side panel */
.preview-flex .preview-section { margin-top:0; }

/* Wizard navigation */
.steps-nav { display:flex; gap:.75rem; margin:0 0 1.8rem; }
.steps-nav .step { flex:1; position:relative; text-align:center; padding:.9rem .5rem; font-size:.68rem; letter-spacing:1px; font-weight:600; text-transform:uppercase; border:1px solid var(--color-border-strong); background:linear-gradient(145deg,var(--color-surface-alt),var(--color-surface)); border-radius:var(--radius-sm); color:var(--color-text-faint); transition:var(--transition); }
.steps-nav .step.active { color:#fff; background:var(--color-accent-gradient); border:1px solid rgba(255,255,255,.1); box-shadow:0 2px 10px -2px rgba(79,140,255,.5); }
.steps-nav .step:not(.active):hover { color:#fff; border-color:var(--color-accent); }

/* Step content container */
.step-content { border:1px solid var(--color-border); background:linear-gradient(145deg,var(--color-surface),var(--color-surface-alt)); padding:1.7rem 1.5rem 2rem; border-radius:var(--radius); margin-bottom:30px; box-shadow:var(--shadow); }

/* Hint / helper box */
.hint-box { margin-top:1rem; padding:.85rem 1rem .95rem; background:linear-gradient(145deg,#1d242c,#202a34); border:1px solid var(--color-border-strong); color:var(--color-text-soft); font-size:.7rem; border-radius:var(--radius-sm); }

/* Wizard actions layout */
.wizard-actions { margin-top:25px; display:flex; gap:.75rem; flex-wrap:wrap; }
.wizard-actions button { flex:1; min-width:150px; }

@media (max-width:900px) { .upload-section { grid-template-columns:1fr; } .field-controls { grid-template-columns:1fr; } .canvas-container { width:100%; } }